package com.bcvgh.core.exploit.exp;

import com.bcvgh.core.exploit.BaseUsage;
import com.bcvgh.core.pojo.Input;
import com.bcvgh.core.pojo.Payload;


import java.util.HashMap;
import java.util.Map;

public class ExpUsageImp extends BaseUsage {
    private ExpTemplateImp expTemplateImp;
    public Map result = new HashMap<>();
    public String type;

    public ExpUsageImp(String url, Payload payload , Input input){
        super(url,payload);
        this.type = payload.type;
        this.ExpUsage(payload,input);
    }

    private void ExpUsage(Payload payload,Input input){
        switch (this.type){
            case "upload":
                this.expTemplateImp = new UploadTemplateImp(this.url,payload,input);
                this.result = this.expTemplateImp.exploitVul(this.type);
                break;
            case "sql":
                break;
            case "deserialize":
                this.expTemplateImp = new DeSerTemplateImp(this.url,payload,input);
                this.result = this.expTemplateImp.exploitVul(this.type);
                break;
            case "exec":
                this.expTemplateImp = new ExecTemplateImp(this.url,payload,input);
                this.result = this.expTemplateImp.exploitVul(this.type);
                break;
            case "custom":
                this.expTemplateImp = new CustomTemplateImp(this.url,payload,input);
                this.result = this.expTemplateImp.exploitVul(this.type);
                break;
            default:
                break;
        }

    }
}
